<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>{{ tr('preview_title') }} - Address Sticker Printer</title>
    <link rel="stylesheet" href="/static/styles.css"/>
  </head>
  <body>
    <div class="container">
      <section class="form-panel" style="margin-top:2rem;">
        <h1 style="margin-top:0;">{{ tr('preview_title') }}</h1>
        <p class="help-text">{{ tf('showing_labels', count=preview_rows|length) }} <strong>{{ template }}</strong></p>

        <ul class="preview-list">
          {% for r in preview_rows %}
          <li>{% if r.title_line_1 %}{{ r.title_line_1 }} - {% endif %}{{ [r.title, r.name, r.surname]|select|join(' ') }} — {{ r.address }} — {{ r.country }}</li>
          {% endfor %}
        </ul>
        <div class="form-panel" style="margin-top:1rem; padding:.6rem;">
          <embed id="pdf-preview" src="{{ pdf_data_uri }}" type="application/pdf" width="100%" height="720px"/>
        </div>


        <form action="/generate" method="post">
          <input type="hidden" name="lang" value="{{ lang }}"/>
          <input type="hidden" name="csv_text" value="{{ csv_text|e }}"/>
          <input type="hidden" name="template" value="{{ template }}"/>
          <input type="hidden" name="top_margin" value="{{ top_margin }}"/>
          <input type="hidden" name="right_margin" value="{{ right_margin }}"/>
          <input type="hidden" name="bottom_margin" value="{{ bottom_margin }}"/>
          <input type="hidden" name="left_margin" value="{{ left_margin }}"/>
          <input type="hidden" name="sender_address" value="{{ sender_address }}"/>
          <input type="hidden" name="font_family" value="{{ font_family }}"/>
          {% if template == 'CUSTOM' and template_spec %}
          <input type="hidden" name="custom_rows" value="{{ template_spec.rows }}"/>
          <input type="hidden" name="custom_cols" value="{{ template_spec.cols }}"/>
          <input type="hidden" name="custom_label_width_mm" value="{{ template_spec.label_width_mm }}"/>
          <input type="hidden" name="custom_label_height_mm" value="{{ template_spec.label_height_mm }}"/>
          <input type="hidden" name="custom_pitch_x_mm" value="{{ template_spec.pitch_x_mm }}"/>
          <input type="hidden" name="custom_pitch_y_mm" value="{{ template_spec.pitch_y_mm }}"/>
          <input type="hidden" name="custom_origin_x_mm" value="{{ template_spec.origin_x_mm }}"/>
          <input type="hidden" name="custom_origin_y_mm" value="{{ template_spec.origin_y_mm }}"/>
          {% endif %}
          <div class="actions">
            <button class="btn" type="submit">{{ tr('generate_pdf') }}</button>
            <a class="btn secondary" href="/?lang={{ lang }}">{{ tr('back') }}</a>
          </div>
        </form>
      </section>
    </div>
  </body>
</html>
